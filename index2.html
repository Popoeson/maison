<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>MAISON ‚Ä¢ Boutique</title>

<!-- Google Fonts -->
<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@500;600&family=Inter:wght@400;500,600&display=swap" rel="stylesheet">

<!-- Font Awesome -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">


  <style>
:root{
  --bg-main:#F5F0E1;
  --text-dark:#2A2A2A;
  --accent-olive:#6B8E23;
}

/* ==========================
   GLOBAL
========================== */
*{margin:0; padding:0; box-sizing:border-box;}
body{font-family:"Inter",sans-serif; background:var(--bg-main); color:var(--text-dark);}
a{text-decoration:none; color:inherit;}
h1,h2,h3{font-family:"Playfair Display",serif;}
.page-content.blur{filter:blur(5px);}

/* ==========================
   HEADER
========================== */
header{
  position:fixed; top:0; width:100%;
  background:rgba(255,255,255,0.96);
  z-index:1000; box-shadow:0 2px 6px rgba(0,0,0,0.05);
}
.header-top{
  display:flex; justify-content:space-between; align-items:center; padding:16px 24px;
}
.logo{font-size:22px; letter-spacing:2px;}
.cart-btn{position:relative; cursor:pointer;}
.cart-btn span{
  position:absolute; top:-6px; right:-8px;
  background:var(--accent-olive); color:#fff; font-size:10px;
  padding:2px 6px; border-radius:50%;
}

/* ==========================
   HERO
========================== */
.hero{
  margin-top:60px; height:80vh; position:relative; overflow:hidden;
}
.hero img{
  position:absolute; inset:0; width:100%; height:100%;
  object-fit:cover; opacity:0; transition:1s; z-index:1;
}
.hero img.active{opacity:1;}
.hero-content{
  position:absolute; inset:0; display:flex; flex-direction:column;
  justify-content:center; align-items:center; text-align:center;
  color:#fff; background:linear-gradient(rgba(0,0,0,0.25), rgba(0,0,0,0.45));
  z-index:2; padding:20px;
}
.hero-content h1{font-size:2.1rem; margin-bottom:10px;}
.hero-content p{font-size:0.95rem; max-width:480px;}
.hero-content .btn{
  margin-top:16px; padding:12px 28px; border-radius:999px;
  border:none; background:var(--accent-olive); color:#fff;
  cursor:pointer; font-weight:500;
}

/* ==========================
   PRODUCTS
========================== */
.section{padding:60px 16px; max-width:1200px; margin:auto;}
.section h2{text-align:center; font-size:1.6rem; margin-bottom:32px;}
.product-grid{display:grid; grid-template-columns:repeat(4,1fr); gap:20px;}
.product-card{
  background:#fff; border-radius:12px; overflow:hidden;
  box-shadow:0 3px 10px rgba(0,0,0,0.05);
}
.product-card img{width:100%; height:180px; object-fit:cover;}
.product-info{padding:12px;}
.product-info h3{font-size:0.95rem; margin-bottom:4px;}
.product-info span{color:var(--accent-olive); font-weight:600; font-size:0.85rem;}
.product-info button,.checkout-btn{
  width:100%; margin-top:6px; padding:8px; border:none;
  border-radius:999px; background:var(--accent-olive);
  color:#fff; font-size:0.8rem; cursor:pointer;
}

/* ==========================
   FEATURED CAROUSEL
========================== */

.featured-wrapper{
  position:relative;
  max-width:1200px;
  margin:auto;
  overflow:hidden;
}

.featured-track{
  display:flex;
  gap:20px;
  scroll-behavior:smooth;
  overflow-x:auto;
  padding:20px 0;
  scrollbar-width:none;
}
.featured-track::-webkit-scrollbar{display:none;}

.featured-track .product-card{
  min-width:220px;
  flex-shrink:0;
  transition:transform 0.4s ease, opacity 0.4s ease;
  transform:scale(0.85);
  opacity:0.6;
}

.featured-track .product-card.active{
  transform:scale(1.05);
  opacity:1;
  z-index:2;
}

@media (max-width: 768px) {

  .featured-wrapper {
    padding: 0;
  }

  .featured-track {
    overflow: hidden;
    padding: 20px 7.5%;
    gap: 0;
  }

  .featured-track .product-card {
    min-width: 85%;
    flex-shrink: 0;
    margin: 0;
    transform: scale(0.9);
    opacity: 0.6;
  }

  .featured-track .product-card.active {
    transform: scale(1);
    opacity: 1;
  }
}

.featured-track {
  scroll-snap-type: x mandatory;
}

.featured-track .product-card {
  scroll-snap-align: center;
}

/* 5 cards visible on desktop 
@media(min-width:1024px){
  .featured-track .product-card{
    min-width:calc(100% / 5 - 16px);
  }
}*/

/* arrows */
.carousel-btn{
  position:absolute;
  top:50%;
  transform:translateY(-50%);
  width:44px;
  height:44px;
  border-radius:50%;
  border:none;
  background:var(--accent-olive);
  color:#fff;
  font-size:1.5rem;
  cursor:pointer;
  z-index:10;
}
.carousel-btn.left{left:-10px;}
.carousel-btn.right{right:-10px;}

.carousel-btn:hover{
  opacity:0.85;
}

/* ==========================
   CART
========================== */
.cart-overlay{
  position:fixed; inset:0; background:rgba(0,0,0,0.35);
  display:none; z-index:1100;
}
.cart-overlay.show{display:block;}
.cart-drawer{
  position:fixed; top:0; right:0; width:360px; height:100%;
  background:#fff; padding:20px;
  box-shadow:-6px 0 20px rgba(0,0,0,0.1);
  transform:translateX(100%); transition:0.3s; z-index:1200;
}
.cart-drawer.open{transform:translateX(0);}
.cart-close-btn{
  position:absolute; top:16px; right:16px;
  font-size:1.2rem; background:none; border:none; cursor:pointer;
}
.cart-items{max-height:60vh; overflow:auto; padding-right:4px;}
.cart-item{
  background:#fafafa; border-radius:14px; padding:12px;
  display:grid; grid-template-columns:70px 1fr; gap:12px;
  margin-bottom:14px; box-shadow:0 4px 12px rgba(0,0,0,0.05);
}
.cart-item img{width:70px; height:70px; border-radius:10px; object-fit:cover;}
.cart-item > div{display:flex; flex-direction:column; justify-content:space-between;}
.cart-item strong{font-size:0.95rem; font-weight:600; margin-bottom:2px;}
.cart-item .item-price{font-size:0.85rem; color:#777; margin-bottom:6px;}
.cart-item-footer{display:flex; align-items:center; justify-content:space-between;}
.qty-controls{display:flex; align-items:center; gap:8px;}
.qty-controls button{
  width:26px; height:26px; border:none; border-radius:50%;
  cursor:pointer; background:#eaeaea; font-weight:600; transition:0.2s;
}
.qty-controls button:hover{background:#ddd;}
.item-total{font-size:0.9rem; font-weight:600; color:var(--accent-olive);}

/* ==========================
   FOOTER
========================== */
.footer{
  background:#1f1f1f; color:#ddd; padding:45px 6% 25px; font-family:"Inter",sans-serif;
}
.footer-container{
  display:grid; grid-template-columns:repeat(auto-fit,minmax(220px,1fr)); gap:32px;
}
.footer-about h3{font-size:1rem; color:green; margin-bottom:6px;}
.footer-about h4{font-size:0.85rem; font-weight:500; color:#bbb; margin-bottom:8px;}
.footer-about p{font-size:0.8rem; line-height:1.6; color:#bbb; max-width:320px;}
.footer-hours h4,.footer-contact h4{font-size:0.9rem; margin-bottom:8px; color:#fff;}
.footer-hours p,.footer-contact p{font-size:0.8rem; margin:4px 0; color:#bbb;}
.footer-bottom{margin-top:28px; padding-top:14px; border-top:1px solid rgba(255,255,255,0.1); text-align:center; font-size:0.7rem; color:#999;}

/* ==========================
   MOBILE
========================== */
@media(max-width:768px){ .product-grid{grid-template-columns:repeat(2,1fr);} }
@media(max-width:600px){ .footer{ text-align:center; padding:35px 5% 20px; } .footer-about p{margin:0 auto;} }
</style>
</head>

<body>

<header>
  <div class="header-top">
    <div class="logo">MAISON</div>

    <div class="cart-btn" onclick="toggleCart()">
      <i class="fa-solid fa-bag-shopping"></i>
      <span id="cartCount">0</span>
    </div>
  </div>
</header>

<!-- PAGE CONTENT -->
<div class="page-content" id="pageContent">

 <section class="hero" id="heroSection">
<div class="hero-content">
    <h1>Curated Essentials for Modern Living</h1>
    <p>Timeless design, sustainable materials, and craftsmanship that speaks for itself.</p>
   <a href="products.html" class="btn">Shop Now</a>
</section>

<section class="section">
  <h2>Featured Products</h2>

  <div class="featured-wrapper">
    <button class="carousel-btn left" id="prevBtn">‚Äπ</button>

    <div class="featured-track" id="featuredTrack"></div>

    <button class="carousel-btn right" id="nextBtn">‚Ä∫</button>
  </div>
</section>
  
<footer class="footer">
  <div class="footer-container">
    <div class="footer-about">
      <h3>Maison Boutique</h3>
      <h4>Curated Essentials for Modern Living</h4>
    <p>Timeless design, sustainable materials, and craftsmanship that speaks for itself.</p>
    </div>

    <div class="footer-hours">
      <h4>Hours</h4>
      <p><span>üïí</span> Monday - Friday: 11am - 10pm</p>
      <p style="margin-left: 22px;">Saturday - Sunday: 10am - 11pm</p>
    </div>

    <div class="footer-contact">
      <h4>Contact</h4>
      <p><span>üìû</span> (123) 456-7890</p>
      <p><span>üìç</span> 123 Main Street, Cityville, State 12345</p>
    </div>
  </div>

  <div class="footer-bottom">
    <p>¬© 2026 Maison Boutique. All rights reserved.</p>
  </div>
</footer>

</div>

<!-- CART OVERLAY -->
<div class="cart-overlay" id="cartOverlay"></div>

<!-- CART DRAWER -->
<div class="cart-drawer" id="cartDrawer">
  <!-- Close button (x) -->
  <button class="cart-close-btn" onclick="closeCart()">√ó</button>
  <h3>Your Cart</h3>
  <div class="cart-items" id="cartItems"></div>
  <div class="cart-total" id="cartTotal"></div>
  <button class="checkout-btn">Checkout</button>
</div>

<script>
// ===============================
// CONFIG
// ===============================
const API_BASE = 'https://maison-90o3.onrender.com';

// ===============================
// STATE
// ===============================
let cart = JSON.parse(localStorage.getItem('cart')) || [];

// ===============================
// HELPERS
// ===============================
function updateCartCount(){
  const count = cart.reduce((sum, item) => sum + item.quantity, 0);

  const cartCount = document.getElementById('cartCount');
  if (cartCount) cartCount.textContent = count;
}

function saveCart(){
  localStorage.setItem('cart', JSON.stringify(cart));
}

// ===============================
// CART LOGIC
// ===============================
function addToCart(product){
  const existing = cart.find(i => i._id === product._id);

  if (existing) {
    existing.quantity++;
  } else {
    cart.push({ ...product, quantity: 1 });
  }

  saveCart();
  updateCartCount();
  renderCart();
}

function changeQty(id, delta){
  const item = cart.find(i => i._id === id);
  if (!item) return;

  item.quantity += delta;

  if (item.quantity <= 0) {
    cart = cart.filter(i => i._id !== id);
  }

  saveCart();
  updateCartCount();
  renderCart();
}

function renderCart(){
  const cartItems = document.getElementById('cartItems');
  const cartTotal = document.getElementById('cartTotal');

  if (!cartItems || !cartTotal) return;

  cartItems.innerHTML = '';
  let total = 0;

  cart.forEach(item => {
    const itemTotal = item.price * item.quantity;
    total += itemTotal;

    cartItems.innerHTML += `
      <div class="cart-item">
        <img src="${item.mainImage}" alt="${item.name}">
        <div>
          <strong>${item.name}</strong>
          <div class="item-price">‚Ç¶${item.price} each</div>

          <div class="cart-item-footer">
            <div class="qty-controls">
              <button onclick="changeQty('${item._id}', -1)">‚àí</button>
              <span>${item.quantity}</span>
              <button onclick="changeQty('${item._id}', 1)">+</button>
            </div>
            <div class="item-total">‚Ç¶${itemTotal}</div>
          </div>
        </div>
      </div>
    `;
  });

  cartTotal.textContent = `Total: ‚Ç¶${total}`;
}

// ===============================
// CART UI
// ===============================
function toggleCart(){
  const drawer = document.getElementById('cartDrawer');
  const overlay = document.getElementById('cartOverlay');
  const page = document.getElementById('pageContent');

  if (!drawer || !overlay || !page) return;

  drawer.classList.toggle('open');
  overlay.classList.toggle('show');
  page.classList.toggle('blur');

  renderCart();
}

function closeCart(){
  const drawer = document.getElementById('cartDrawer');
  const overlay = document.getElementById('cartOverlay');
  const page = document.getElementById('pageContent');

  if (!drawer || !overlay || !page) return;

  drawer.classList.remove('open');
  overlay.classList.remove('show');
  page.classList.remove('blur');
}

// Close cart when clicking overlay
const overlay = document.getElementById('cartOverlay');
if (overlay) {
  overlay.addEventListener('click', closeCart);
}

// ===============================
// HERO CAROUSEL
// ===============================
async function fetchHeroes(){
  try {
    const res = await fetch(`${API_BASE}/api/hero-images`);
    const data = await res.json();

    const heroSection = document.getElementById('heroSection');
    if (!heroSection) return;

    const activeImages = data.filter(img => img.isActive);
    if (!activeImages.length) return;

    let index = 0;

    activeImages.forEach((img, i) => {
      const image = document.createElement('img');
      image.src = img.imageUrl;
      if (i === 0) image.classList.add('active');
      heroSection.appendChild(image);
    });

    setInterval(() => {
      const images = heroSection.querySelectorAll('img');
      images.forEach(img => img.classList.remove('active'));
      images[index].classList.add('active');
      index = (index + 1) % images.length;
    }, 5000);

  } catch (err) {
    console.error('Hero fetch failed:', err);
  }
}

//====================
// PRODUCT FETCH
//=====================
async function fetchProducts() {
  try {
    const res = await fetch("/api/products");
    const products = await res.json();

    console.log("Products:", products);
    // render products here
  } catch (err) {
    console.error("Failed to fetch products:", err);
  }
}

// ===============================
// FEATURED PRODUCTS CAROUSEL
// ===============================
let autoScrollInterval;
let currentIndex = 0;
let cardWidth = 0;

function isMobile() {
  return window.innerWidth <= 768;
}

async function fetchFeaturedProducts() {
  try {
    const res = await fetch(`${API_BASE}/api/products`);
    const products = await res.json();

    const featured = products.filter(p => p.featured === true);
    const track = document.getElementById('featuredTrack');
    if (!track || featured.length === 0) return;

    track.innerHTML = '';

    featured.forEach(p => {
      track.innerHTML += `
        <div class="product-card">
          <img src="${p.mainImage}" alt="${p.name}">
          <div class="product-info">
            <h3>${p.name}</h3>
            <span>‚Ç¶${p.price}</span>
            <button onclick='addToCart(${JSON.stringify(p)})'>
              Add to Cart
            </button>
          </div>
        </div>
      `;
    });

    requestAnimationFrame(() => {
      calculateCardWidth();
      activateCard(0);
      startAutoplay();
    });

    window.addEventListener('resize', () => {
      calculateCardWidth();
      activateCard(currentIndex);
    });

  } catch (err) {
    console.error('Featured products fetch failed', err);
  }
}

// ===============================
// WIDTH CALCULATION (KEY CHANGE)
// ===============================
function calculateCardWidth() {
  const track = document.getElementById('featuredTrack');
  const firstCard = track.querySelector('.product-card');
  if (!firstCard) return;

  const cardStyles = getComputedStyle(firstCard);
  const trackStyles = getComputedStyle(track);

  const cardWidthRaw = firstCard.offsetWidth;
  const gap = parseFloat(trackStyles.columnGap || trackStyles.gap || 0);

  cardWidth = cardWidthRaw + gap;
}

// ===============================
// ACTIVE CARD LOGIC
// ===============================
function activateCard(index) {
  const track = document.getElementById('featuredTrack');
  const cards = [...track.children];

  cards.forEach(card => card.classList.remove('active'));
  cards[index].classList.add('active');

  const card = cards[index];
  const trackCenter = track.offsetWidth / 2;
  const cardCenter = card.offsetLeft + card.offsetWidth / 2;

  track.scrollTo({
    left: cardCenter - trackCenter,
    behavior: 'smooth'
  });

  currentIndex = index;
}

// ===============================
// AUTOPLAY LOGIC
// ===============================
function startAutoplay() {
  stopAutoplay();

  const track = document.getElementById('featuredTrack');
  const cardsCount = track.children.length;

  autoScrollInterval = setInterval(() => {
    let nextIndex = currentIndex + 1;
    if (nextIndex >= cardsCount) nextIndex = 0;
    activateCard(nextIndex);
  }, 3500);
}

function stopAutoplay() {
  if (autoScrollInterval) clearInterval(autoScrollInterval);
}

const track = document.getElementById('featuredTrack');
track?.addEventListener('mouseenter', stopAutoplay);
track?.addEventListener('mouseleave', startAutoplay);

// ===============================
// TOUCH / SCROLL DETECTION
// ===============================
function enableTouchScroll() {
  const track = document.getElementById('featuredTrack');
  if (!track) return;

  let scrollTimeout;

  track.addEventListener('scroll', () => {
    isUserInteracting = true;
    stopAutoplay();

    clearTimeout(scrollTimeout);
    scrollTimeout = setTimeout(() => {
      snapToClosestCard();
      isUserInteracting = false;
      startAutoplay();
    }, 150);
  });
}

// ===============================
// SNAP TO NEAREST CARD
// ===============================
function snapToClosestCard() {
  const track = document.getElementById('featuredTrack');
  const cards = [...track.children];
  const trackCenter = track.scrollLeft + track.offsetWidth / 2;

  let closestIndex = 0;
  let closestDistance = Infinity;

  cards.forEach((card, index) => {
    const cardCenter = card.offsetLeft + card.offsetWidth / 2;
    const distance = Math.abs(trackCenter - cardCenter);

    if (distance < closestDistance) {
      closestDistance = distance;
      closestIndex = index;
    }
  });

  activateCard(closestIndex);
}

// ===============================
// ARROW BUTTON LOGIC
// ===============================
document.getElementById('prevBtn')?.addEventListener('click', () => {
  const track = document.getElementById('featuredTrack');
  const cardsCount = track.children.length;
  activateCard((currentIndex - 1 + cardsCount) % cardsCount);
});

document.getElementById('nextBtn')?.addEventListener('click', () => {
  const track = document.getElementById('featuredTrack');
  const cardsCount = track.children.length;
  activateCard((currentIndex + 1) % cardsCount);
});

// ===============================
// INIT
// ===============================
updateCartCount();
fetchHeroes();
fetchProducts();
fetchFeaturedProducts();
</script>
</body>
</html>